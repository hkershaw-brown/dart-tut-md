
---

# DART Tutorial Section 14:  
### DART Observation Quality Control  

---

### Observation Sequence Files

DART uses observation sequence files to store information about observations available for assimilation.

Default file names:
1. `obs_seq.in`: Input to `perfect_model_obs` for OSSEs.
2. `obs_seq.out`: Input to the filter (output from `perfect_model_obs`).
3. `obs_seq.final`: Output from the filter.

These files contain metadata about observations and may include values like the actual observation, prior ensemble estimates, etc.

---

### Quality Control Summary

Each observation can have a prior quality control (QC) value.  
DART adds its own QC value when observation sequences are generated.

QC values in `obs_seq.final` generated by the filter:
- **0**: Assimilated
- **1**: Evaluated only
- **2**: Assimilated, but posterior forward operator(s) failed
- **3**: Evaluated only, but posterior forward operator(s) failed
- **4**: Not used, prior forward operator(s) failed
- **5**: Not used, not selected in `obs_kind_nml`
- **6**: Not used, failed prior QC check
- **7**: Not used, violated outlier threshold

---

### Quality Control Details

DART provides runtime control over which types of observations in an observation sequence file are assimilated by the filter, controlled in the `&obs_kind_nml`:

- **`assimilate_these_obs_types`**: A list of observation types to be assimilated.
- **`evaluate_these_obs_types`**: A list of observation types to be evaluated (withheld observations).

Observations not listed in either will be ignored.

---

### Quality Control Values

- **0, 2**: The observation was assimilated.
  - Observation type listed in `assimilate_these_obs_types`.
- **1, 3**: The observation was evaluated (not assimilated).
  - Observation type listed in `evaluate_these_obs_types`.

- **5**: The observation was not used (not listed in `&obs_kind_nml`).
- **6**: The observation failed the prior QC check (e.g., due to large prior QC values).
  - Threshold is set by `input_qc_threshold` in `&quality_control_nml`.

---

### Outlier Threshold Quality Control

- DART QC value 7 indicates that the outlier threshold was exceeded.
- Observations are rejected if the difference between the prior mean and observation exceeds a multiple (T) of the expected value:
  \[
  T \cdot \sqrt{\sigma_{\text{prior}}^2 + \sigma_{\text{obs}}^2}
  \]
- **T** is set by `outlier_threshold` in `&quality_control_nml`. A negative value turns off the outlier check.

**Example**:
- Large models have `outlier_threshold` set to 3 standard deviations.
- In smaller models like `lorenz_96` or `lorenz_63`, try setting `outlier_threshold` to 2.0 or 1.5 to see its impact on assimilation quality.

---

### DART Tutorial Index

1. Filtering for a One Variable System
2. The DART Directory Tree
3. DART Runtime Control and Documentation
4. How Observations Impact Unobserved State Variables
5. Comprehensive Filtering Theory
6. Other Updates for an Observed Variable
7. Some Additional Low-Order Models
8. Dealing with Sampling Error
9. More on Dealing with Error: Inflation
10. Regression and Nonlinear Effects
11. Creating DART Executables
12. Adaptive Inflation
13. Hierarchical Group Filters and Localization
14. **Quality Control**
15. DART Experiments: Control and Design

---

